# 技术选型文档

## 1. 前端技术栈

### 1.1 框架选择
**React 18 + TypeScript**
- **理由**：
  - 成熟的生态系统和丰富的组件库
  - 良好的TypeScript支持，类型安全
  - 虚拟DOM，性能优秀
  - 社区活跃，文档完善

### 1.2 UI框架
**Ant Design 5.x**
- **理由**：
  - 企业级UI组件库
  - 丰富的组件（上传、表格、表单等）
  - 良好的中文支持
  - 主题定制能力强

### 1.3 状态管理
**Zustand / Redux Toolkit**
- **理由**：
  - 轻量级，API简洁
  - 适合中小型应用
  - 性能优秀

### 1.4 路由
**React Router v6**
- **理由**：
  - 官方推荐
  - 支持嵌套路由
  - 代码分割

### 1.5 HTTP客户端
**Axios**
- **理由**：
  - 支持请求/响应拦截
  - 自动JSON转换
  - 请求取消
  - 错误处理完善

### 1.6 文件上传
**react-dropzone + 自定义上传组件**
- **理由**：
  - 支持拖拽上传
  - 文件预览
  - 上传进度显示

### 1.7 构建工具
**Vite**
- **理由**：
  - 快速的热更新
  - 优化的生产构建
  - 支持TypeScript

## 2. 后端技术栈

### 2.1 Web框架
**FastAPI**
- **理由**：
  - 高性能（基于Starlette和Pydantic）
  - 自动API文档（Swagger）
  - 异步支持
  - Python生态丰富
  - 类型提示支持

### 2.2 数据库
**PostgreSQL 15+**
- **理由**：
  - 成熟稳定
  - 支持JSON字段
  - 全文搜索支持
  - 良好的并发性能

**Redis 7+**
- **理由**：
  - 缓存
  - 会话存储
  - 任务队列

### 2.3 向量数据库
**Qdrant / Milvus / Chroma**
- **推荐：Qdrant**
- **理由**：
  - 性能优秀
  - RESTful API
  - 支持过滤
  - 易于部署

### 2.4 对象存储
**MinIO / AWS S3 / 阿里云OSS**
- **推荐：MinIO（本地）或云存储（生产）**
- **理由**：
  - S3兼容API
  - 支持大文件
  - 高可用

### 2.5 ORM
**SQLAlchemy 2.0 + Alembic**
- **理由**：
  - 成熟的ORM
  - 数据库迁移工具
  - 支持异步

### 2.6 任务队列
**Celery + Redis**
- **理由**：
  - 异步任务处理
  - 文件解析任务
  - 向量化任务

### 2.7 认证授权
**JWT + OAuth2**
- **理由**：
  - 无状态认证
  - 安全性高
  - 易于扩展

## 3. AI模型选型

### 3.1 文本Embedding模型
**选项1：本地部署**
- **m3e-base / bge-large-zh-v1.5**
- **理由**：
  - 中文支持好
  - 可本地部署
  - 成本低

**选项2：API调用**
- **OpenAI text-embedding-3-large**
- **Azure OpenAI Embeddings**
- **理由**：
  - 性能优秀
  - 无需维护

### 3.2 大语言模型（LLM）
**选项1：本地部署**
- **Qwen2.5 / ChatGLM3 / Llama3**
- **理由**：
  - 数据安全
  - 成本可控
  - 可定制

**选项2：API调用**
- **OpenAI GPT-4 / GPT-4 Turbo**
- **Azure OpenAI**
- **Claude 3.5 Sonnet**
- **理由**：
  - 性能优秀
  - 多模态支持
  - 无需维护

**推荐方案：混合模式**
- 基础问题使用本地模型
- 复杂问题使用API模型
- 用户可选择

### 3.3 多模态模型
**选项1：本地部署**
- **Qwen-VL / LLaVA**
- **理由**：
  - 支持图片理解
  - 可本地部署

**选项2：API调用**
- **GPT-4 Vision**
- **Claude 3.5 Sonnet**
- **理由**：
  - 性能优秀
  - 图片理解能力强

### 3.4 OCR模型
**PaddleOCR / EasyOCR**
- **理由**：
  - 中文OCR效果好
  - 可本地部署
  - 开源免费

## 4. 文件处理库

### 4.1 PDF处理
- **PyPDF2 / pdfplumber**：文本提取
- **pdf2image**：PDF转图片

### 4.2 PPT处理
- **python-pptx**：PPT解析
- **unoconv**：PPT转PDF

### 4.3 Word处理
- **python-docx**：DOCX解析
- **mammoth**：DOCX转HTML

### 4.4 Excel处理
- **openpyxl / pandas**：XLSX解析

### 4.5 图片处理
- **Pillow**：图片处理
- **opencv-python**：图片预处理

## 5. 部署技术

### 5.1 容器化
**Docker + Docker Compose**
- **理由**：
  - 环境一致性
  - 易于部署
  - 资源隔离

### 5.2 编排
**Kubernetes（可选）**
- **理由**：
  - 自动扩缩容
  - 高可用
  - 服务发现

### 5.3 反向代理
**Nginx**
- **理由**：
  - 负载均衡
  - SSL终止
  - 静态资源服务

### 5.4 监控
**Prometheus + Grafana**
- **理由**：
  - 指标收集
  - 可视化
  - 告警

### 5.5 日志
**ELK Stack / Loki**
- **理由**：
  - 日志聚合
  - 日志搜索
  - 日志分析

## 6. 开发工具

### 6.1 代码质量
- **Black**：代码格式化
- **flake8 / pylint**：代码检查
- **mypy**：类型检查
- **ESLint + Prettier**：前端代码质量

### 6.2 测试
- **pytest**：后端测试
- **Jest + React Testing Library**：前端测试

### 6.3 CI/CD
- **GitHub Actions / GitLab CI**
- **理由**：
  - 自动化测试
  - 自动化部署

## 7. 技术架构图

```
┌─────────────────┐
│   前端 (React)   │
│  Ant Design UI  │
└────────┬────────┘
         │ HTTPS
┌────────▼────────┐
│   Nginx 反向代理 │
└────────┬────────┘
         │
┌────────▼────────┐
│  FastAPI 后端   │
│  - REST API     │
│  - WebSocket    │
└────────┬────────┘
         │
    ┌────┴────┬──────────┬──────────┐
    │         │          │          │
┌───▼───┐ ┌──▼───┐ ┌───▼───┐ ┌───▼───┐
│PostgreSQL│ │Redis │ │ Qdrant │ │ MinIO │
│  数据库  │ │ 缓存 │ │向量数据库│ │对象存储│
└─────────┘ └──────┘ └───────┘ └───────┘
         │
┌────────▼────────┐
│  Celery Worker  │
│  异步任务处理    │
└────────┬────────┘
         │
    ┌────┴────┬──────────┬──────────┐
    │         │          │          │
┌───▼───┐ ┌──▼───┐ ┌───▼───┐
│ LLM API│ │Embedding│ │ OCR   │
│ 模型   │ │  模型   │ │ 模型  │
└────────┘ └────────┘ └───────┘
```

## 8. 技术选型总结

| 层级 | 技术 | 版本 | 备注 |
|------|------|------|------|
| 前端框架 | React | 18.x | TypeScript |
| UI组件 | Ant Design | 5.x | 企业级UI |
| 后端框架 | FastAPI | 0.104+ | Python 3.11+ |
| 关系数据库 | PostgreSQL | 15+ | 主数据库 |
| 缓存 | Redis | 7+ | 缓存和队列 |
| 向量数据库 | Qdrant | 1.7+ | Embeddings存储 |
| 对象存储 | MinIO | Latest | 文件存储 |
| 任务队列 | Celery | 5.3+ | 异步任务 |
| 容器化 | Docker | Latest | 部署 |
| 编排 | Kubernetes | 1.28+ | 可选 |
